---
title: "Assingment 04"
author: "Pierina Forastieri and Sylvia Brown"
date: "2/25/2022"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(warning = FALSE)

```

```{r include = FALSE}
def.chunk.hook  <- knitr::knit_hooks$get("chunk")
knitr::knit_hooks$set(chunk = function(x, options) {
  x <- def.chunk.hook(x, options)
  ifelse(options$size != "normalsize", paste0("\n \\", options$size,"\n\n", x, "\n\n \\normalsize"), x)
})

```

\begin{center}
\Huge{PPOL 670 | Assignment 4}

\Huge{Data Visualization, Markdown, and Git}
\end{center}

\vspace{0.1in}

```{r}
library(tidyverse)
library(janitor)
library(ggplot2)
library(maps)
library(mapdata)
library(gganimate)
```


# Dataset selection

```{r}
data <- read_csv("data/Download-data-in-Excel.csv")

data <- data %>%
  janitor::clean_names()

data <- data %>%
  filter(economy == "Argentina" |  economy == "Bolivia" |  economy == "Brazil" |  economy == "Chile" |  economy == "Colombia" |  economy == "Costa Rica" |  economy == "Dominican Rep." |  economy == "Ecuador" |  economy == "El Salvador" |  economy == "Guatemala" |  economy == "Honduras "|  economy == "Mexico" |  economy == "Nicaragua" |  economy == "Panama"|  economy == "Paraguay" |  economy == "Peru" |  economy == "Puerto Rico" |  economy == "Uruguay" |  economy == "Venezuela")
```

\newpage

# Four ggplot2 graphs (4 points)

## Graph 01: 
TO DOs
Sylvia to look into how to make a graph for Latin America
```{r}
# Sylvia to return to this
```

\newpage

## Graph 02: 

We wanted to see how access to financial services changed over time in each country. ***Need more
TO-DOs
Add title and subtitle
Make sure the years at the bottom aren't overlapping
Remove countries for which we don't have dat (Bolivia, El Salvador, and Peru)
```{r}
graph1 <- data %>%
  ggplot() + 
  geom_line(mapping = aes(x = year, y = no_of_mobile_and_internet_banking_transac_during_reference_yr_per_1_000_adults, color = economy)) +
  facet_wrap(~ economy) +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal()
graph1
```

\newpage

## Graph 3: bar graph
```{r}
graph3 <- data %>% 
  filter(year == 2020, economy != "Ecuador" ) %>%
  ggplot() +
  aes(x = outstanding_deposits_with_commercial_banks_percent_of_gdp , y = economy, show.legend = FALSE) +
  geom_col(aes(fill = economy), width = 0.7) +
  geom_text(aes(label = outstanding_deposits_with_commercial_banks_percent_of_gdp), hjust = -0.1) +
  labs(
    title = "Outstanding Deposits with Commercial Banks in Latin America Countries",
    subtitle = "(as % of GDP)",
    caption = "Source: IMF Financial Access Survey (FAS)",
    x = "Outstanding Deposits % GDP",
    y = "Countries"
  ) +
  theme_minimal()
graph3 + theme(legend.position = "none")
```
\newpage

## Graph 4:
```{r}
graph4 <- data %>% 
   ggplot() +
  aes(x = number_of_commercial_bank_branches_per_100_000_adults , y = outstanding_deposits_with_commercial_banks_percent_of_gdp, color = economy) +
  geom_point(size = 2) +
  theme_minimal() +
  labs(title = 'Year: {frame_time}', x = 'of Commercial Branches per 100,000 adults', y = 'Outstanding deposits with commercial banks as percentage of GDP') +
  transition_time(year) +
  ease_aes('linear') +
  labs(
    title = "Relationship between number of commercial bank branches and outstanding deposits in Latin America Countries",
    subtitle = "(from 2004 to 2020)",
    caption = "Source: IMF Financial Access Survey (FAS)",
    x = "Number of Commercial Bank Branches per 100,000 Adults",
    y = "Outstanding Deposits with Commercial Banks as % of GDP"
  ) 

animate(graph4, duration = 17, fps = 17, width = 800, height = 800, renderer = gifski_renderer())
graph4
```





